@model IList<OfficeAvenger.Domain.Mission>

<h4>Missions</h4>
@foreach (var mission in Model)
{
    <div class="mission crush">
        <div class="clearfix">
            <div class="mission-name"><a href="/razor/mission/@mission.Id/edit">@mission.Name</a></div>
            <div class="right">
                <div class="mission-duration">@mission.Duration mins</div>
                <div class="mission-start">
                    @if (mission.MissionStart.HasValue)
                    {
                        @mission.MissionStart.Value.ToShortTimeString()
                    }
                    else
                    {
                        <form action="/razor/mission/start" method="post" class="inline hugme">
                        @Html.Hidden("missionId", mission.Id)
                        <a href="#" onclick="$(this).closest('form').submit();" class="button tiny hugme">Begin</a>
                        </form>
                    }
                </div>
                <div class="mission-end">@DisplayTime(mission.MissionEnd)</div>
            </div>
        </div>
        <div class="mission-team clearfix">
            @foreach (var hero in mission.Team)
            {
                <img src="@hero.Avatar" class="left avatar" title="@hero.Name" />
            }
        </div>
    </div>
}
<a class="button" href="/razor/mission/add">New Mission</a>

@helper DisplayTime(DateTime? nullableDateTime, string nullString = "")
{
    @(nullableDateTime.HasValue ? nullableDateTime.Value.ToShortTimeString() : nullString)
}